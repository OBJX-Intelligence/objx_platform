<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OBJX Intelligence - Complete Methodology</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            min-height: 100vh;
            color: #ffffff;
            font-weight: 400;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            opacity: 0;
            animation: pageLoad 0.8s ease-out forwards;
        }

        @keyframes pageLoad {
            to {
                opacity: 1;
            }
        }

        .header {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px 0;
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            width: 32px;
            height: 32px;
            animation: logoBreath 3s ease-in-out infinite;
        }

        @keyframes logoBreath {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.02);
            }
        }

        .brand-name {
            font-size: 20px;
            font-weight: 300;
            letter-spacing: -0.3px;
        }

        .brand-name .accent {
            color: #8B5CF6;
            font-weight: 400;
        }

        .tier-badge {
            background: linear-gradient(135deg, #DC2626 0%, #B91C1C 100%);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .white-label-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            color: #ffffff;
            font-size: 12px;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .white-label-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .main-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px 24px;
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 40px;
        }

        .dashboard-section {
            display: flex;
            flex-direction: column;
            gap: 40px;
        }

        .command-center {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 32px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .command-title {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .command-subtitle {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 16px;
        }

        .methodology-text {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 32px;
        }

        .methodology-text::before {
            content: "• ";
            color: #DC2626;
        }

        .methodology-text::after {
            content: " •";
            color: #DC2626;
        }

        .agent-status {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }

        .agent-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(20px);
            animation: agentCardSlideIn 0.5s ease-out forwards;
        }

        .agent-card:nth-child(1) { animation-delay: 0.1s; }
        .agent-card:nth-child(2) { animation-delay: 0.2s; }
        .agent-card:nth-child(3) { animation-delay: 0.3s; }
        .agent-card:nth-child(4) { animation-delay: 0.4s; }

        @keyframes agentCardSlideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .agent-card:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(220, 38, 38, 0.3);
            transform: translateY(-4px);
        }

        .agent-status-indicator {
            width: 12px;
            height: 12px;
            background: #10B981;
            border-radius: 50%;
            position: relative;
        }

        .agent-status-indicator::after {
            content: "";
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            background: rgba(16, 185, 129, 0.3);
            border-radius: 50%;
            animation: pulse 2s ease-out infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 0.8;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        .agent-info {
            flex: 1;
        }

        .agent-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .agent-activity {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 16px;
        }

        .quick-action-btn {
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.2) 0%, rgba(185, 28, 28, 0.2) 100%);
            border: 1px solid rgba(220, 38, 38, 0.3);
            border-radius: 12px;
            padding: 16px;
            color: #ffffff;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .quick-action-btn:hover {
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.3) 0%, rgba(185, 28, 28, 0.3) 100%);
            border-color: rgba(220, 38, 38, 0.5);
            transform: translateY(-4px);
            box-shadow: 0 10px 20px rgba(220, 38, 38, 0.15);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            letter-spacing: -0.3px;
        }

        .new-project-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 8px 16px;
            color: #ffffff;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .new-project-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 24px;
        }

        .project-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateX(-30px);
            animation: projectSlideIn 0.6s ease-out forwards;
        }

        .project-card:nth-child(1) { animation-delay: 0.1s; }
        .project-card:nth-child(2) { animation-delay: 0.2s; }

        @keyframes projectSlideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .project-card:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(220, 38, 38, 0.3);
            transform: translateY(-6px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .project-status {
            width: 8px;
            height: 8px;
            background: #10B981;
            border-radius: 50%;
            margin-bottom: 16px;
        }

        .project-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .project-type {
            font-size: 12px;
            color: #DC2626;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .project-description {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.5;
            margin-bottom: 16px;
        }

        .project-meta {
            display: flex;
            gap: 12px;
        }

        .project-meta span {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            background: rgba(255, 255, 255, 0.05);
            padding: 4px 8px;
            border-radius: 4px;
        }

        .advanced-programs {
            margin-top: 16px;
        }

        .programs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 24px;
        }

        .program-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(30px);
            animation: programFadeUp 0.6s ease-out forwards;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .program-card:nth-child(1) { animation-delay: 0.1s; }
        .program-card:nth-child(2) { animation-delay: 0.2s; }
        .program-card:nth-child(3) { animation-delay: 0.3s; }
        .program-card:nth-child(4) { animation-delay: 0.4s; }
        .program-card:nth-child(5) { animation-delay: 0.5s; }

        .program-card:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(220, 38, 38, 0.3);
            transform: translateY(-6px);
            box-shadow: 0 20px 48px rgba(220, 38, 38, 0.15);
        }

        @keyframes programFadeUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .program-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #DC2626 0%, #B91C1C 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 12px;
            font-size: 20px;
        }

        .program-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 6px;
        }

        .program-description {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.4;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 24px;
            opacity: 0;
            transform: translateX(30px);
            animation: sidebarSlideIn 0.8s ease-out 0.6s forwards;
        }

        @keyframes sidebarSlideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .proactive-insights {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
        }

        .insight-item {
            background: rgba(220, 38, 38, 0.1);
            border: 1px solid rgba(220, 38, 38, 0.2);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
        }

        .insight-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 6px;
        }

        .insight-description {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.4;
        }

        .document-generation {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
        }

        .document-templates {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 16px;
        }

        .template-btn {
            background: rgba(220, 38, 38, 0.1);
            border: 1px solid rgba(220, 38, 38, 0.2);
            border-radius: 8px;
            padding: 12px;
            color: #ffffff;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .template-btn:hover {
            background: rgba(220, 38, 38, 0.2);
            border-color: rgba(220, 38, 38, 0.3);
        }

        .white-label-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
        }

        .white-label-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .white-label-description {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.5;
            margin-bottom: 16px;
        }

        .white-label-button {
            display: inline-block;
            background: linear-gradient(135deg, #DC2626 0%, #B91C1C 100%);
            border-radius: 8px;
            padding: 12px 20px;
            color: #ffffff;
            font-size: 14px;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .white-label-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(220, 38, 38, 0.2);
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #1a1a1a;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 32px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
        }

        .close-modal {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 24px;
            cursor: pointer;
        }

        .modal-body {
            margin-bottom: 24px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 16px;
        }

        .modal-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 12px 20px;
            color: #ffffff;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn.primary {
            background: linear-gradient(135deg, #DC2626 0%, #B91C1C 100%);
            border: none;
        }

        .modal-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .modal-btn.primary:hover {
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(220, 38, 38, 0.2);
        }

        /* Form styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            color: #ffffff;
            font-size: 14px;
        }

        .form-input:focus {
            outline: none;
            border-color: rgba(220, 38, 38, 0.5);
        }

        .form-select {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            color: #ffffff;
            font-size: 14px;
            appearance: none;
        }

        .form-textarea {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            color: #ffffff;
            font-size: 14px;
            min-height: 120px;
            resize: vertical;
        }

        /* Loading indicator */
        .loading-indicator {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-left-color: #DC2626;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loading-text {
            margin-top: 16px;
            font-size: 16px;
            font-weight: 500;
            color: #ffffff;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: rgba(16, 185, 129, 0.9);
            color: #ffffff;
            padding: 16px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 3000;
        }

        .toast.error {
            background: rgba(220, 38, 38, 0.9);
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        /* Fix for device pixel ratio issues */
        @media screen and (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo-section">
                <svg class="logo" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M16 2C8.268 2 2 8.268 2 16C2 23.732 8.268 30 16 30C23.732 30 30 23.732 30 16C30 8.268 23.732 2 16 2ZM16 28C9.373 28 4 22.627 4 16C4 9.373 9.373 4 16 4C22.627 4 28 9.373 28 16C28 22.627 22.627 28 16 28Z" fill="white"/>
                    <path d="M16 8C11.582 8 8 11.582 8 16C8 20.418 11.582 24 16 24C20.418 24 24 20.418 24 16C24 11.582 20.418 8 16 8ZM16 22C12.686 22 10 19.314 10 16C10 12.686 12.686 10 16 10C19.314 10 22 12.686 22 16C22 19.314 19.314 22 16 22Z" fill="#DC2626"/>
                    <path d="M16 12C13.791 12 12 13.791 12 16C12 18.209 13.791 20 16 20C18.209 20 20 18.209 20 16C20 13.791 18.209 12 16 12ZM16 18C14.895 18 14 17.105 14 16C14 14.895 14.895 14 16 14C17.105 14 18 14.895 18 16C18 17.105 17.105 18 16 18Z" fill="white"/>
                </svg>
                <div class="brand-name">
                    OBJX<span class="accent">Intelligence</span>
                </div>
                <div class="tier-badge">TIER 3 - COMPLETE METHODOLOGY</div>
            </div>
            <div class="user-section">
                <a href="#" class="white-label-btn">White Label Inquiry</a>
                <button onclick="logout()" style="background: none; border: none; color: rgba(255,255,255,0.6); cursor: pointer;">Logout</button>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="dashboard-section">
            <div class="command-center">
                <h1 class="command-title">Master Systematic Thinking with Automation</h1>
                <p class="command-subtitle">Agent-powered command center with complete methodology access</p>
                <p class="methodology-text">clarify • compound • create</p>
                
                <div class="agent-status" id="agent-status-container">
                    <!-- Agent status cards will be populated dynamically -->
                    <div class="agent-card">
                        <div class="agent-status-indicator"></div>
                        <div class="agent-info">
                            <div class="agent-name">Loading agents...</div>
                            <div class="agent-activity">Initializing system</div>
                        </div>
                    </div>
                </div>

                <div class="quick-actions">
                    <button class="quick-action-btn" onclick="generateDocument()">Generate Document</button>
                    <button class="quick-action-btn" onclick="runAnalysis()">Run Analysis</button>
                    <button class="quick-action-btn" onclick="orchestrateAgents()">Orchestrate Agents</button>
                    <button class="quick-action-btn" onclick="optimizeWorkflow()">Optimize Workflow</button>
                </div>
            </div>

            <div class="projects-section">
                <div class="section-header">
                    <h2 class="section-title">Advanced Projects</h2>
                    <button class="new-project-btn" onclick="createAdvancedProject()">+ New Advanced Project</button>
                </div>
                <div class="projects-grid">
                    <div class="project-card" onclick="openProject('enterprise-1')">
                        <div class="project-status"></div>
                        <div class="project-title">Enterprise Development Hub</div>
                        <div class="project-type">COMPLETE METHODOLOGY</div>
                        <div class="project-description">Full-scale development project with automated document generation, regulatory navigation, and systematic workflow optimization.</div>
                        <div class="project-meta">
                            <span>Agent-managed</span>
                            <span>Auto-updating</span>
                        </div>
                    </div>
                    <div class="project-card" onclick="openProject('enterprise-2')">
                        <div class="project-status"></div>
                        <div class="project-title">Municipal Integration System</div>
                        <div class="project-type">REGULATORY NAVIGATION</div>
                        <div class="project-description">Complete permit and approval process automation with systematic thinking methodology.</div>
                        <div class="project-meta">
                            <span>Proactive monitoring</span>
                            <span>95% automated</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="advanced-programs">
                <div class="section-header">
                    <h2 class="section-title">Complete Methodology Programs</h2>
                </div>
                <div class="programs-grid" id="programs-container">
                    <!-- Program cards will be populated dynamically -->
                    <div class="program-card">
                        <div class="program-icon">📄</div>
                        <div class="program-title">Loading programs...</div>
                        <div class="program-description">Initializing methodology programs.</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="sidebar">
            <div class="proactive-insights">
                <h3 class="section-title">Proactive Intelligence</h3>
                <div id="insights-container">
                    <!-- Insights will be populated dynamically -->
                    <div class="insight-item">
                        <div class="insight-title">Loading insights...</div>
                        <div class="insight-description">Initializing proactive intelligence system.</div>
                    </div>
                </div>
            </div>

            <div class="document-generation">
                <h3 class="section-title">Document Generation</h3>
                <div class="document-templates" id="templates-container">
                    <!-- Templates will be populated dynamically -->
                    <button class="template-btn">Loading templates...</button>
                </div>
            </div>

            <div class="white-label-section">
                <h3 class="white-label-title">Ready for White Label?</h3>
                <p class="white-label-description">
                    License the complete systematic thinking methodology for your organization with custom branding and deployment.
                </p>
                <a href="#" class="white-label-button">Explore White Label</a>
            </div>
        </div>
    </main>

    <!-- Document Generation Modal -->
    <div id="document-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Generate Document</h2>
                <button class="close-modal" onclick="closeModal('document-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Template</label>
                    <select id="document-template" class="form-select">
                        <option value="">Select a template</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Title</label>
                    <input type="text" id="document-title" class="form-input" placeholder="Enter document title">
                </div>
                <div class="form-group">
                    <label class="form-label">Content</label>
                    <textarea id="document-content" class="form-textarea" placeholder="Enter document content or leave blank for AI generation"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn" onclick="closeModal('document-modal')">Cancel</button>
                <button class="modal-btn primary" onclick="submitDocumentGeneration()">Generate</button>
            </div>
        </div>
    </div>

    <!-- Analysis Modal -->
    <div id="analysis-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Run Analysis</h2>
                <button class="close-modal" onclick="closeModal('analysis-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Analysis Type</label>
                    <select id="analysis-type" class="form-select">
                        <option value="market">Market Analysis</option>
                        <option value="competitive">Competitive Analysis</option>
                        <option value="financial">Financial Analysis</option>
                        <option value="risk">Risk Assessment</option>
                        <option value="regulatory">Regulatory Analysis</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Data Input</label>
                    <textarea id="analysis-data" class="form-textarea" placeholder="Enter data for analysis or leave blank for sample data"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn" onclick="closeModal('analysis-modal')">Cancel</button>
                <button class="modal-btn primary" onclick="submitAnalysis()">Run Analysis</button>
            </div>
        </div>
    </div>

    <!-- Agent Orchestration Modal -->
    <div id="orchestration-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Orchestrate Agents</h2>
                <button class="close-modal" onclick="closeModal('orchestration-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Workflow Name</label>
                    <input type="text" id="workflow-name" class="form-input" placeholder="Enter workflow name">
                </div>
                <div class="form-group">
                    <label class="form-label">Workflow Description</label>
                    <textarea id="workflow-description" class="form-textarea" placeholder="Describe what you want the agents to accomplish"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Agents to Include</label>
                    <div id="agent-selection">
                        <!-- Agent checkboxes will be populated dynamically -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn" onclick="closeModal('orchestration-modal')">Cancel</button>
                <button class="modal-btn primary" onclick="submitOrchestration()">Start Orchestration</button>
            </div>
        </div>
    </div>

    <!-- Loading Indicator -->
    <div class="loading-indicator" id="loading-indicator">
        <div class="spinner"></div>
        <div class="loading-text" id="loading-text">Processing...</div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast-notification"></div>

    <script>
        // Global variables
        let agentStatus = {};
        let documentTemplates = [];
        let userToken = 'mock_token_' + Math.random().toString(36).substring(2);
        
        // Initialize the dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Fix for device pixel ratio issues
            (function() {
                const dpr = window.devicePixelRatio;
                console.log('Device Pixel Ratio:', dpr);
                
                if (dpr < 1) {
                    const scaleFactor = 1 / dpr;
                    console.log('Applying scale factor:', scaleFactor);
                    
                    // Apply scaling to fix low DPR display
                    document.documentElement.style.transform = `scale(${scaleFactor})`;
                    document.documentElement.style.transformOrigin = 'top left';
                    document.documentElement.style.width = `${100 / scaleFactor}%`;
                    document.documentElement.style.height = `${100 / scaleFactor}%`;
                    
                    console.log('DPR scaling fix applied');
                }
            })();
            
            // Initialize the dashboard
            initializeDashboard();
        });

        // Initialize dashboard with API data
        async function initializeDashboard() {
            try {
                // Fetch agent status
                await fetchAgentStatus();
                
                // Fetch document templates
                await fetchDocumentTemplates();
                
                // Fetch programs
                await fetchPrograms();
                
                // Fetch insights
                await fetchInsights();
                
                // Show success toast
                showToast('Dashboard initialized successfully', 'success');
            } catch (error) {
                console.error('Error initializing dashboard:', error);
                showToast('Error initializing dashboard. Using demo data.', 'error');
                
                // Use demo data as fallback
                useDemoData();
            }
        }

        // Fetch agent status from API
        async function fetchAgentStatus() {
            showLoading('Fetching agent status...');
            
            try {
                const response = await fetch('/api/agents/status');
                const data = await response.json();
                
                if (data.agents) {
                    agentStatus = data.agents;
                    updateAgentStatusUI(data.agents);
                }
            } catch (error) {
                console.error('Error fetching agent status:', error);
                throw error;
            } finally {
                hideLoading();
            }
        }

        // Update agent status UI
        function updateAgentStatusUI(agents) {
            const container = document.getElementById('agent-status-container');
            container.innerHTML = '';
            
            // Get agent IDs
            const agentIds = Object.keys(agents);
            
            // Create agent cards
            agentIds.forEach(agentId => {
                const agent = agents[agentId];
                const card = document.createElement('div');
                card.className = 'agent-card';
                
                card.innerHTML = `
                    <div class="agent-status-indicator"></div>
                    <div class="agent-info">
                        <div class="agent-name">${getAgentName(agentId)}</div>
                        <div class="agent-activity">${agent.current_task || 'Idle'}</div>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        // Get agent name from ID
        function getAgentName(agentId) {
            const agentNames = {
                'document_generator': 'Document Agent',
                'analysis_engine': 'Analysis Agent',
                'memory_optimizer': 'Memory Agent',
                'workflow_agent': 'Workflow Agent'
            };
            
            return agentNames[agentId] || `Agent ${agentId}`;
        }

        // Fetch document templates from API
        async function fetchDocumentTemplates() {
            showLoading('Fetching document templates...');
            
            try {
                const response = await fetch('/api/documents/templates');
                const data = await response.json();
                
                if (data.success && data.templates) {
                    documentTemplates = data.templates;
                    updateDocumentTemplatesUI(data.templates);
                }
            } catch (error) {
                console.error('Error fetching document templates:', error);
                throw error;
            } finally {
                hideLoading();
            }
        }

        // Update document templates UI
        function updateDocumentTemplatesUI(templates) {
            const container = document.getElementById('templates-container');
            container.innerHTML = '';
            
            // Create template buttons
            templates.forEach(template => {
                const button = document.createElement('button');
                button.className = 'template-btn';
                button.textContent = getTemplateDisplayName(template);
                button.onclick = () => generateTemplateDocument(template);
                
                container.appendChild(button);
            });
            
            // Update modal select options
            const templateSelect = document.getElementById('document-template');
            templateSelect.innerHTML = '<option value="">Select a template</option>';
            
            templates.forEach(template => {
                const option = document.createElement('option');
                option.value = template;
                option.textContent = getTemplateDisplayName(template);
                templateSelect.appendChild(option);
            });
        }

        // Get template display name
        function getTemplateDisplayName(templateId) {
            const templateNames = {
                'proposal': 'Business Proposal',
                'analysis': 'Market Analysis',
                'report': 'Project Report',
                'feasibility': 'Feasibility Study',
                'presentation': 'Presentation Deck'
            };
            
            return templateNames[templateId] || templateId;
        }

        // Fetch programs from API
        async function fetchPrograms() {
            showLoading('Fetching programs...');
            
            try {
                // In a real implementation, this would fetch from an API
                // For now, we'll use demo data
                const programs = [
                    {
                        id: 'document-creation',
                        title: 'Full Document Creation',
                        description: 'Visual reports, comprehensive proposals, and feasibility studies with systematic methodology.',
                        icon: '📄'
                    },
                    {
                        id: 'agent-orchestration',
                        title: 'Agent Orchestration',
                        description: 'Complete automation with systematic thinking-guided agent coordination.',
                        icon: '🎭'
                    },
                    {
                        id: 'project-management',
                        title: 'Advanced Project Management',
                        description: 'Full business ecosystem replacement with systematic workflow optimization.',
                        icon: '📊'
                    },
                    {
                        id: 'visual-analytics',
                        title: 'Visual Analytics',
                        description: 'Charts, graphs, and comprehensive reporting with systematic intelligence.',
                        icon: '📈'
                    },
                    {
                        id: 'regulatory-navigation',
                        title: 'Regulatory Navigation',
                        description: 'Complete permit and approval process optimization with systematic approach.',
                        icon: '🏛️'
                    }
                ];
                
                updateProgramsUI(programs);
            } catch (error) {
                console.error('Error fetching programs:', error);
                throw error;
            } finally {
                hideLoading();
            }
        }

        // Update programs UI
        function updateProgramsUI(programs) {
            const container = document.getElementById('programs-container');
            container.innerHTML = '';
            
            // Create program cards
            programs.forEach(program => {
                const card = document.createElement('div');
                card.className = 'program-card';
                card.onclick = () => openProgram(program.id);
                
                card.innerHTML = `
                    <div class="program-icon">${program.icon}</div>
                    <div class="program-title">${program.title}</div>
                    <div class="program-description">${program.description}</div>
                `;
                
                container.appendChild(card);
            });
        }

        // Fetch insights from API
        async function fetchInsights() {
            showLoading('Fetching insights...');
            
            try {
                // In a real implementation, this would fetch from an API
                // For now, we'll use demo data
                const insights = [
                    {
                        title: 'Opportunity Identified',
                        description: 'Market analysis suggests optimal timing for Phase 2 expansion. Systematic risk assessment recommends proceeding.'
                    },
                    {
                        title: 'Process Optimization',
                        description: 'Agent orchestration has reduced project timeline by 40% through systematic workflow improvements.'
                    },
                    {
                        title: 'Regulatory Update',
                        description: 'New municipal requirements detected. Automatic compliance adjustments applied to active projects.'
                    }
                ];
                
                updateInsightsUI(insights);
            } catch (error) {
                console.error('Error fetching insights:', error);
                throw error;
            } finally {
                hideLoading();
            }
        }

        // Update insights UI
        function updateInsightsUI(insights) {
            const container = document.getElementById('insights-container');
            container.innerHTML = '';
            
            // Create insight items
            insights.forEach(insight => {
                const item = document.createElement('div');
                item.className = 'insight-item';
                
                item.innerHTML = `
                    <div class="insight-title">${insight.title}</div>
                    <div class="insight-description">${insight.description}</div>
                `;
                
                container.appendChild(item);
            });
        }

        // Use demo data as fallback
        function useDemoData() {
            // Demo agent status
            const demoAgents = {
                'document_generator': {
                    status: 'idle',
                    last_active: new Date().toISOString(),
                    current_task: 'Generating feasibility report',
                    completed_tasks: 12,
                    health: 'optimal'
                },
                'analysis_engine': {
                    status: 'idle',
                    last_active: new Date().toISOString(),
                    current_task: 'Monitoring market trends',
                    completed_tasks: 8,
                    health: 'optimal'
                },
                'memory_optimizer': {
                    status: 'idle',
                    last_active: new Date().toISOString(),
                    current_task: 'Processing regulatory data',
                    completed_tasks: 15,
                    health: 'optimal'
                },
                'workflow_agent': {
                    status: 'idle',
                    last_active: new Date().toISOString(),
                    current_task: 'Optimizing project timeline',
                    completed_tasks: 6,
                    health: 'optimal'
                }
            };
            
            updateAgentStatusUI(demoAgents);
            
            // Demo document templates
            const demoTemplates = ['proposal', 'analysis', 'report', 'feasibility', 'presentation'];
            updateDocumentTemplatesUI(demoTemplates);
            
            // Demo programs
            fetchPrograms();
            
            // Demo insights
            fetchInsights();
        }

        // Generate document
        function generateDocument() {
            // Show document generation modal
            showModal('document-modal');
        }

        // Submit document generation
        async function submitDocumentGeneration() {
            const template = document.getElementById('document-template').value;
            const title = document.getElementById('document-title').value;
            const content = document.getElementById('document-content').value;
            
            if (!template) {
                showToast('Please select a template', 'error');
                return;
            }
            
            if (!title) {
                showToast('Please enter a document title', 'error');
                return;
            }
            
            showLoading('Generating document...');
            closeModal('document-modal');
            
            try {
                const response = await fetch('/api/documents/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${userToken}`
                    },
                    body: JSON.stringify({
                        template_id: template,
                        title: title,
                        content: content ? { custom: content } : {}
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showToast('Document generated successfully', 'success');
                    // In a real implementation, this would open the document
                } else {
                    showToast('Error generating document: ' + (data.error || 'Unknown error'), 'error');
                }
            } catch (error) {
                console.error('Error generating document:', error);
                showToast('Error generating document. Using demo mode.', 'error');
                
                // Demo success
                setTimeout(() => {
                    showToast('Document generated successfully (Demo)', 'success');
                }, 2000);
            } finally {
                hideLoading();
            }
        }

        // Generate template document
        function generateTemplateDocument(template) {
            document.getElementById('document-template').value = template;
            document.getElementById('document-title').value = `New ${getTemplateDisplayName(template)}`;
            document.getElementById('document-content').value = '';
            
            showModal('document-modal');
        }

        // Run analysis
        function runAnalysis() {
            // Show analysis modal
            showModal('analysis-modal');
        }

        // Submit analysis
        async function submitAnalysis() {
            const analysisType = document.getElementById('analysis-type').value;
            const analysisData = document.getElementById('analysis-data').value;
            
            showLoading('Running analysis...');
            closeModal('analysis-modal');
            
            try {
                const response = await fetch('/api/analysis/run', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${userToken}`
                    },
                    body: JSON.stringify({
                        analysis_type: analysisType,
                        data: analysisData ? { custom: analysisData } : {}
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showToast('Analysis completed successfully', 'success');
                    // In a real implementation, this would show the analysis results
                } else {
                    showToast('Error running analysis: ' + (data.error || 'Unknown error'), 'error');
                }
            } catch (error) {
                console.error('Error running analysis:', error);
                showToast('Error running analysis. Using demo mode.', 'error');
                
                // Demo success
                setTimeout(() => {
                    showToast('Analysis completed successfully (Demo)', 'success');
                }, 2000);
            } finally {
                hideLoading();
            }
        }

        // Orchestrate agents
        function orchestrateAgents() {
            // Populate agent selection
            const agentSelection = document.getElementById('agent-selection');
            agentSelection.innerHTML = '';
            
            const agentIds = Object.keys(agentStatus);
            if (agentIds.length === 0) {
                // Use demo agents if no agents are available
                const demoAgentIds = ['document_generator', 'analysis_engine', 'memory_optimizer', 'workflow_agent'];
                
                demoAgentIds.forEach(agentId => {
                    const checkbox = document.createElement('div');
                    checkbox.innerHTML = `
                        <label style="display: block; margin-bottom: 8px;">
                            <input type="checkbox" name="agent" value="${agentId}" checked>
                            ${getAgentName(agentId)}
                        </label>
                    `;
                    
                    agentSelection.appendChild(checkbox);
                });
            } else {
                agentIds.forEach(agentId => {
                    const checkbox = document.createElement('div');
                    checkbox.innerHTML = `
                        <label style="display: block; margin-bottom: 8px;">
                            <input type="checkbox" name="agent" value="${agentId}" checked>
                            ${getAgentName(agentId)}
                        </label>
                    `;
                    
                    agentSelection.appendChild(checkbox);
                });
            }
            
            // Show orchestration modal
            showModal('orchestration-modal');
        }

        // Submit orchestration
        async function submitOrchestration() {
            const workflowName = document.getElementById('workflow-name').value;
            const workflowDescription = document.getElementById('workflow-description').value;
            
            if (!workflowName) {
                showToast('Please enter a workflow name', 'error');
                return;
            }
            
            if (!workflowDescription) {
                showToast('Please enter a workflow description', 'error');
                return;
            }
            
            // Get selected agents
            const selectedAgents = [];
            const agentCheckboxes = document.querySelectorAll('input[name="agent"]:checked');
            agentCheckboxes.forEach(checkbox => {
                selectedAgents.push(checkbox.value);
            });
            
            if (selectedAgents.length === 0) {
                showToast('Please select at least one agent', 'error');
                return;
            }
            
            showLoading('Orchestrating agents...');
            closeModal('orchestration-modal');
            
            try {
                const response = await fetch('/api/agents/orchestrate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${userToken}`
                    },
                    body: JSON.stringify({
                        workflow_data: {
                            name: workflowName,
                            description: workflowDescription,
                            agents: selectedAgents
                        }
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showToast('Workflow orchestration started successfully', 'success');
                    // In a real implementation, this would show the workflow status
                } else {
                    showToast('Error orchestrating workflow: ' + (data.error || 'Unknown error'), 'error');
                }
            } catch (error) {
                console.error('Error orchestrating workflow:', error);
                showToast('Error orchestrating workflow. Using demo mode.', 'error');
                
                // Demo success
                setTimeout(() => {
                    showToast('Workflow orchestration started successfully (Demo)', 'success');
                }, 2000);
            } finally {
                hideLoading();
            }
        }

        // Optimize workflow
        function optimizeWorkflow() {
            showLoading('Optimizing workflow...');
            
            try {
                // In a real implementation, this would call an API
                // For now, we'll simulate a successful optimization
                setTimeout(() => {
                    hideLoading();
                    showToast('Workflow optimization completed successfully', 'success');
                }, 2000);
            } catch (error) {
                console.error('Error optimizing workflow:', error);
                hideLoading();
                showToast('Error optimizing workflow', 'error');
            }
        }

        // Open project
        function openProject(projectId) {
            window.location.href = `/project/${projectId}?tier=3`;
        }

        // Create advanced project
        function createAdvancedProject() {
            window.location.href = `/project/new?tier=3&type=advanced`;
        }

        // Open program
        function openProgram(programId) {
            window.location.href = `/chat?program=${programId}&tier=3`;
        }

        // Show modal
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'flex';
        }

        // Close modal
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'none';
        }

        // Show loading indicator
        function showLoading(text) {
            const loadingIndicator = document.getElementById('loading-indicator');
            const loadingText = document.getElementById('loading-text');
            
            loadingText.textContent = text || 'Processing...';
            loadingIndicator.style.display = 'flex';
        }

        // Hide loading indicator
        function hideLoading() {
            const loadingIndicator = document.getElementById('loading-indicator');
            loadingIndicator.style.display = 'none';
        }

        // Show toast notification
        function showToast(message, type) {
            const toast = document.getElementById('toast-notification');
            toast.textContent = message;
            toast.className = `toast ${type || ''}`;
            
            // Show toast
            setTimeout(() => {
                toast.classList.add('show');
            }, 100);
            
            // Hide toast after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Logout
        function logout() {
            window.location.href = '/';
        }
    </script>
</body>
</html>

